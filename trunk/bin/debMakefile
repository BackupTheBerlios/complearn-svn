#!/usr/bin/make -f
# -*- makefile -*-

all: debs

debs: mdebs cldebs gdebs csdebs

addkey:
	wget -q "http://cilibrar.com/debian/gpgkey-E0CFA8E4.txt" -O - | sudo apt-key add -

mdebs:
	cd complearn-mpi && aclocal && automake && autoconf && ./configure --enable-optimize && make dist && cd .. && tar xvfz complearn-mpi/complearn-mpi-0.9.3.tar.gz && cd complearn-mpi-0.9.3 && cp -rv ../complearn-mpi/debian . && dpkg-buildpackage -isvn/ -us -uc -sa -rfakeroot && cd ..

gdebs:
	cp -rv gui complearn-gui-0.93 && cd complearn-gui-0.93 && dpkg-buildpackage -isvn/ -us -uc -sa -rfakeroot

cldebs:
	cd core && make dist && cd .. && tar xvfz core/libcomplearn-0.9.2.tar.gz && cd libcomplearn-0.9.2 && cp -rv ../core/debian . && dpkg-buildpackage -isvn/ -us -uc -sa -rfakeroot

csdebs:
	cp -rv libcsoap-package/libcsoap libcsoap-1.047 && cd libcsoap-1.047 && cp ../libcsoap-package/extern/*orig.tar.gz ../libcsoap-1.047.orig.tar.gz && dpkg-buildpackage -isvn/ -us -uc -sa -rfakeroot && fakeroot ./debian/rules clean

deploy:
	scp *.deb *.dsc *.changes libcomp*gz cilibrar@cilibrar.com:public_html/cilibrarcom/debian/pool/main/l/libcomplearn && ssh cilibrar@cilibrar.com /home/cilibrar/bin/upa pkgarc main

clean:
	rm -rf complearn-mpi-0.9.3 complearn-mpi-0.9.3* libcomplearn-0.9.2 complearn-gui-0.93 libcsoap-1.047 complearn-gui* libcomplearn-0.93 comp*.deb libcomp*.deb libcomp*.dsc libcomp*gz libcomp*.changes libcomp.*.dsc libcs*.deb libcs*gz libcs*changes libna*deb libcs*dsc && cd core && fakeroot ./debian/rules clean


